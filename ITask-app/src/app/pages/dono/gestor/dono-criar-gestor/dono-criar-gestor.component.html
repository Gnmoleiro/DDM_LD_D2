<form [formGroup]="managerForm" (ngSubmit)="onSubmit()" class="container-sm my-4 p-0">
  <h2 class="mb-4 text-center">Criar Novo Gestor</h2>

  <div class="row g-3">
    <div class="col-12">
      <ion-item fill="outline" class="w-100">
        <ion-input label="Email" type="email" formControlName="email"></ion-input>
      </ion-item>
      @if (managerForm.get('email')?.invalid && managerForm.get('email')?.touched) {
        <div class="text-danger small mt-1 ps-3">
          @if (managerForm.get('email')?.errors?.['required']) {
            <span>O email é obrigatório.</span>
          }
          @if (managerForm.get('email')?.errors?.['email']) {
            <span>Insira um email válido.</span>
          }
        </div>
      }
    </div>

    <div class="col-12">
      <ion-item fill="outline" class="w-100">
        <ion-input label="Nome" type="text" formControlName="nome"></ion-input>
      </ion-item>
      @if (managerForm.get('nome')?.invalid && managerForm.get('nome')?.touched) {
        <div class="text-danger small mt-1 ps-3">
          @if (managerForm.get('nome')?.errors?.['required']) {
            <span>O nome é obrigatório.</span>
          }
        </div>
      }
    </div>

    <div class="col-12">
      <ion-item fill="outline" class="w-100">
        <ion-select formControlName="departamento" placeholder="Selecione o Departamento">
          @for (dept of departamentos; track dept) {
            <ion-select-option [value]="dept">{{ dept }}</ion-select-option>
          }
        </ion-select>
      </ion-item>
      @if (managerForm.get('departamento')?.invalid && managerForm.get('departamento')?.touched) {
        <div class="text-danger small mt-1 ps-3">
          <span>O departamento é obrigatório.</span>
        </div>
      }
    </div>

    <div class="col-12 mt-4">
      <ion-button 
        type="submit" 
        expand="block" 
        size="large"
        [disabled]="managerForm.invalid || isSubmitting"
      >
      </ion-button>
    </div>
  </div>
</form>

@if (tempPassword) {
  <ion-card color="success" class="mt-4">
    <ion-card-header>
      <ion-card-title>✅ Sucesso!</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      Gestor criado com sucesso. A senha temporária é: 
      <p class="fs-5 fw-bold text-center mt-2">{{ tempPassword }}</p>
    </ion-card-content>
  </ion-card>
}

@if (errorMessage) {
  <ion-card color="danger" class="mt-4">
    <ion-card-header>
      <ion-card-title>❌ Erro</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      {{ errorMessage }}
    </ion-card-content>
  </ion-card>
}